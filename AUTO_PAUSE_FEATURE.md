# 自动暂停功能说明

## 功能概述

当用户在手机上玩游戏时，如果切换到其他应用或回到主屏幕，游戏会自动暂停。当用户重新回到游戏时，需要手动点击屏幕或暂停按钮来恢复游戏。

## 实现原理

### 1. 页面可见性监听
- 使用 `document.addEventListener('visibilitychange', ...)` 监听页面可见性变化
- 当 `document.hidden` 为 `true` 时，表示页面被隐藏（用户切换到其他应用）

### 2. 页面焦点监听
- 使用 `window.addEventListener('blur', ...)` 监听页面失去焦点
- 作为页面可见性监听的备用方案

### 3. 自动暂停逻辑
```javascript
// 在 App.tsx 中实现
if (document.hidden) {
    // 页面隐藏时自动暂停游戏
    if (!gameState.isPaused && !gameState.isGameOver && snakeScene.isGameActive()) {
        snakeScene.setPauseState(true);
    }
}
```

### 4. 手动恢复
- 页面重新可见时不自动恢复游戏
- 用户需要点击暂停覆盖层或暂停按钮来恢复游戏
- 暂停覆盖层显示 "PAUSED 点击屏幕继续"

## 代码修改

### App.tsx
- 添加了页面可见性和焦点变化监听
- 只在页面隐藏时自动暂停，不在页面重新可见时自动恢复

### SnakeScene.ts
- 添加了 `isGameActive()` 方法来检查游戏状态
- 添加了 `setPauseState()` 方法来设置暂停状态
- 修改了暂停覆盖层，添加了点击事件处理
- 暂停文本显示为 "PAUSED 点击屏幕继续"

## 测试方法

1. 在手机上打开游戏
2. 开始游戏，让蛇开始移动
3. 切换到其他应用（如微信、浏览器等）或按Home键回到主屏幕
4. 等待几秒钟
5. 重新回到游戏页面
6. 检查游戏是否已暂停，并显示暂停覆盖层
7. 点击屏幕或暂停按钮来恢复游戏

## 预期行为

✅ **自动暂停**: 切换到其他应用时，游戏自动暂停
✅ **显示暂停覆盖层**: 回到游戏时，显示 "PAUSED 点击屏幕继续"
✅ **点击恢复**: 点击屏幕可以恢复游戏
✅ **按钮恢复**: 点击暂停按钮也可以恢复游戏
✅ **不自动恢复**: 页面重新可见时不会自动恢复游戏

## 兼容性

- 支持所有现代移动浏览器
- 支持 iOS Safari、Android Chrome、微信内置浏览器等
- 使用标准的 Web API，无需额外依赖

## 注意事项

1. 此功能仅在移动设备上有效
2. 需要游戏处于活动状态才会触发自动暂停
3. 游戏结束后不会触发自动暂停
4. 用户必须手动点击来恢复游戏，确保用户有意识地恢复游戏 