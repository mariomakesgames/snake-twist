<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🐍 Snake Game - Tutorial Button Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
            font-size: 2.5em;
        }

        .test-info {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #007bff;
        }

        .test-steps {
            background: #fff3cd;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            border-left: 4px solid #ffc107;
        }

        .test-steps h3 {
            color: #856404;
            margin-top: 0;
        }

        .test-steps ol {
            color: #856404;
        }

        .controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            justify-content: center;
            margin-bottom: 20px;
        }

        .button {
            background: linear-gradient(45deg, #007bff, #0056b3);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 123, 255, 0.3);
        }

        .button:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 123, 255, 0.4);
        }

        .button:active {
            transform: translateY(0);
        }

        .game-container {
            border: 2px solid #ddd;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .status {
            background: #e9ecef;
            border-radius: 10px;
            padding: 15px;
            text-align: center;
            font-weight: bold;
            color: #495057;
        }

        .debug-info {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin-top: 20px;
            font-family: monospace;
            font-size: 14px;
            max-height: 200px;
            overflow-y: auto;
        }

        .debug-info h4 {
            margin-top: 0;
            color: #495057;
        }

        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-radius: 3px;
        }

        .log-info {
            background: #d1ecf1;
            color: #0c5460;
        }

        .log-success {
            background: #d4edda;
            color: #155724;
        }

        .log-warning {
            background: #fff3cd;
            color: #856404;
        }

        .log-error {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>🐍 Snake Game - Tutorial Button Test</h1>
        
        <div class="test-info">
            <h3>测试目标</h3>
            <p>验证tutorial popup的continue按钮点击功能是否正常工作。修复了按钮文本交互性和移动输入管理器干扰的问题。</p>
        </div>
        
        <div class="test-steps">
            <h3>测试步骤</h3>
            <ol>
                <li>开始游戏，吃绿色食物（应该显示教程，游戏暂停）</li>
                <li>点击"Continue"按钮（应该关闭教程并恢复游戏）</li>
                <li>继续游戏，吃其他颜色的食物（每种第一次都会显示教程）</li>
                <li>测试点击按钮的不同区域（背景、文字）</li>
                <li>检查控制台日志，确认按钮点击事件正常触发</li>
                <li>在移动设备上测试触摸点击功能</li>
            </ol>
        </div>
        
        <div class="controls">
            <button class="button" onclick="startNewGame()">开始新游戏</button>
            <button class="button" onclick="resetTutorials()">重置教程</button>
            <button class="button" onclick="showTutorialStatus()">显示教程状态</button>
            <button class="button" onclick="clearLogs()">清除日志</button>
        </div>
        
        <div class="game-container">
            <div id="game-root"></div>
        </div>
        
        <div class="status" id="status">
            状态: 等待开始游戏...
        </div>

        <div class="debug-info">
            <h4>调试日志</h4>
            <div id="debugLogs"></div>
        </div>
    </div>

    <script type="module">
        import { createApp } from 'https://unpkg.com/vue@3/dist/vue.esm-browser.js';
        import SnakeGame from './src/PhaserGame.tsx';
        
        // 创建Vue应用
        const app = createApp({
            components: {
                SnakeGame
            },
            template: '<SnakeGame />'
        });
        
        // 挂载到DOM
        app.mount('#game-root');
        
        // 全局函数
        window.startNewGame = function() {
            const gameState = window.gameState;
            if (gameState) {
                gameState.score = 0;
                gameState.savedSnakeLength = undefined;
                gameState.isReviving = false;
                gameState.isGameOver = false;
                gameState.isPaused = false;
                
                // 重新加载页面以开始新游戏
                location.reload();
            }
        };
        
        window.resetTutorials = function() {
            try {
                localStorage.removeItem('snake_food_tutorials_shown');
                log('教程已重置，重新开始游戏将显示所有教程', 'success');
                document.getElementById('status').innerHTML = '状态: 教程已重置，重新开始游戏将显示所有教程';
            } catch (error) {
                log('重置教程失败: ' + error.message, 'error');
                document.getElementById('status').innerHTML = '状态: 重置教程失败: ' + error.message;
            }
        };
        
        window.showTutorialStatus = function() {
            try {
                const savedState = localStorage.getItem('snake_food_tutorials_shown');
                const shownTutorials = savedState ? JSON.parse(savedState) : [];
                log(`已显示的教程: ${shownTutorials.join(', ') || '无'}`, 'info');
                document.getElementById('status').innerHTML = `状态: 已显示 ${shownTutorials.length} 个教程`;
            } catch (error) {
                log('获取教程状态失败: ' + error.message, 'error');
            }
        };
        
        window.clearLogs = function() {
            document.getElementById('debugLogs').innerHTML = '';
        };
        
        // 日志函数
        function log(message, type = 'info') {
            const logsContainer = document.getElementById('debugLogs');
            const logEntry = document.createElement('div');
            logEntry.className = `log-entry log-${type}`;
            
            const timestamp = new Date().toLocaleTimeString();
            logEntry.innerHTML = `[${timestamp}] ${message}`;
            
            logsContainer.appendChild(logEntry);
            logsContainer.scrollTop = logsContainer.scrollHeight;
            
            // 限制日志数量
            while (logsContainer.children.length > 50) {
                logsContainer.removeChild(logsContainer.firstChild);
            }
        }
        
        // 监听控制台日志
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            log(args.join(' '), 'info');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            log(args.join(' '), 'warning');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            log(args.join(' '), 'error');
        };
        
        // 页面加载完成
        window.addEventListener('load', () => {
            log('页面加载完成，开始测试tutorial按钮功能', 'success');
        });
        
        // 监听游戏状态变化
        setInterval(() => {
            const gameState = window.gameState;
            if (gameState) {
                const status = document.getElementById('status');
                if (gameState.isGameOver) {
                    status.innerHTML = '状态: 游戏结束';
                } else if (gameState.isPaused) {
                    status.innerHTML = '状态: 游戏暂停';
                } else {
                    status.innerHTML = `状态: 游戏中 (分数: ${gameState.score})`;
                }
            }
        }, 1000);
    </script>
</body>
</html> 