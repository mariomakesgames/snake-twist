<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Obstacle Revival Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background: #1a1a1a;
            color: #fff;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        h1 {
            text-align: center;
            color: #4CAF50;
        }
        
        .test-panel {
            background: #333;
            padding: 20px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .button {
            background: #4CAF50;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .button:hover {
            background: #66BB6A;
        }
        
        .button.danger {
            background: #f44336;
        }
        
        .button.danger:hover {
            background: #ef5350;
        }
        
        .status {
            background: #444;
            padding: 15px;
            border-radius: 4px;
            margin: 10px 0;
        }
        
        .log {
            background: #222;
            padding: 15px;
            border-radius: 4px;
            max-height: 300px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        
        .log-entry {
            margin: 2px 0;
            padding: 2px 0;
        }
        
        .log-entry.info {
            color: #4CAF50;
        }
        
        .log-entry.warn {
            color: #FF9800;
        }
        
        .log-entry.error {
            color: #f44336;
        }
        
        .log-entry.success {
            color: #4CAF50;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ§± éšœç¢ç‰©å¤æ´»æµ‹è¯•</h1>
        
        <div class="test-panel">
            <h3>æµ‹è¯•è¯´æ˜</h3>
            <p>è¿™ä¸ªæµ‹è¯•é¡µé¢ç”¨äºéªŒè¯éšœç¢ç‰©åœ¨å¤æ´»æ—¶çš„ä¿å­˜å’Œæ¢å¤åŠŸèƒ½ï¼š</p>
            <ul>
                <li>1. å¼€å§‹æ–°æ¸¸æˆæ—¶ç”Ÿæˆéšœç¢ç‰©</li>
                <li>2. æ¸¸æˆç»“æŸæ—¶ä¿å­˜éšœç¢ç‰©ä½ç½®</li>
                <li>3. å¤æ´»æ—¶æ¢å¤ç›¸åŒçš„éšœç¢ç‰©å¸ƒå±€</li>
                <li>4. éªŒè¯éšœç¢ç‰©ä¸ä¼šæ¶ˆå¤±æˆ–æ”¹å˜ä½ç½®</li>
            </ul>
        </div>
        
        <div class="test-panel">
            <h3>æµ‹è¯•æ§åˆ¶</h3>
            <button class="button" onclick="startNewGame()">ğŸ® å¼€å§‹æ–°æ¸¸æˆ</button>
            <button class="button danger" onclick="simulateGameOver()">ğŸ’€ æ¨¡æ‹Ÿæ¸¸æˆç»“æŸ</button>
            <button class="button" onclick="simulateRevival()">ğŸ”„ æ¨¡æ‹Ÿå¤æ´»</button>
            <button class="button" onclick="checkObstacles()">ğŸ” æ£€æŸ¥éšœç¢ç‰©</button>
            <button class="button" onclick="clearLog()">ğŸ—‘ï¸ æ¸…ç©ºæ—¥å¿—</button>
        </div>
        
        <div class="status" id="status">
            <strong>å½“å‰çŠ¶æ€:</strong> æœªå¼€å§‹
        </div>
        
        <div class="log" id="log">
            <div class="log-entry info">ğŸš€ éšœç¢ç‰©å¤æ´»æµ‹è¯•å·²å¯åŠ¨</div>
            <div class="log-entry info">ğŸ“‹ ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•</div>
        </div>
    </div>

    <script>
        let isLogging = true;
        let gameState = {
            score: 0,
            isGameOver: false,
            isReviving: false,
            savedObstaclePositions: null,
            savedSnakeLength: null
        };

        function log(message, type = 'info') {
            if (!isLogging) return;
            
            const logElement = document.getElementById('log');
            const entry = document.createElement('div');
            entry.className = `log-entry ${type}`;
            entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
            logElement.appendChild(entry);
            logElement.scrollTop = logElement.scrollHeight;
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '';
            log('ğŸ—‘ï¸ æ—¥å¿—å·²æ¸…ç©º', 'info');
        }

        function updateStatus() {
            const statusElement = document.getElementById('status');
            statusElement.innerHTML = `
                <strong>å½“å‰çŠ¶æ€:</strong><br>
                åˆ†æ•°: ${gameState.score}<br>
                æ¸¸æˆç»“æŸ: ${gameState.isGameOver}<br>
                å¤æ´»ä¸­: ${gameState.isReviving}<br>
                ä¿å­˜çš„éšœç¢ç‰©: ${gameState.savedObstaclePositions ? gameState.savedObstaclePositions.length : 0}ä¸ª<br>
                ä¿å­˜çš„è›‡é•¿åº¦: ${gameState.savedSnakeLength || 'æ— '}
            `;
        }

        function startNewGame() {
            log('ğŸ® å¼€å§‹æ–°æ¸¸æˆ...', 'info');
            
            // é‡ç½®æ¸¸æˆçŠ¶æ€
            gameState.score = 0;
            gameState.isGameOver = false;
            gameState.isReviving = false;
            gameState.savedObstaclePositions = null;
            gameState.savedSnakeLength = null;
            
            // æ¨¡æ‹Ÿç”Ÿæˆéšœç¢ç‰©
            const obstacleCount = Math.floor(Math.random() * 10) + 5; // 5-15ä¸ªéšœç¢ç‰©
            const obstacles = [];
            
            for (let i = 0; i < obstacleCount; i++) {
                obstacles.push({
                    x: Math.floor(Math.random() * 600),
                    y: Math.floor(Math.random() * 800)
                });
            }
            
            log(`ğŸ§± ç”Ÿæˆäº† ${obstacles.length} ä¸ªéšœç¢ç‰©`, 'success');
            log(`ğŸ“ éšœç¢ç‰©ä½ç½®: ${JSON.stringify(obstacles.slice(0, 3))}...`, 'info');
            
            updateStatus();
        }

        function simulateGameOver() {
            if (gameState.isGameOver) {
                log('âš ï¸ æ¸¸æˆå·²ç»ç»“æŸ', 'warn');
                return;
            }
            
            log('ğŸ’€ æ¨¡æ‹Ÿæ¸¸æˆç»“æŸ...', 'info');
            
            gameState.isGameOver = true;
            gameState.savedSnakeLength = Math.floor(Math.random() * 10) + 5; // 5-15é•¿åº¦
            
            // æ¨¡æ‹Ÿä¿å­˜éšœç¢ç‰©
            const obstacleCount = Math.floor(Math.random() * 10) + 5;
            gameState.savedObstaclePositions = [];
            
            for (let i = 0; i < obstacleCount; i++) {
                gameState.savedObstaclePositions.push({
                    x: Math.floor(Math.random() * 600),
                    y: Math.floor(Math.random() * 800)
                });
            }
            
            log(`ğŸ’¾ ä¿å­˜äº† ${gameState.savedObstaclePositions.length} ä¸ªéšœç¢ç‰©ä½ç½®`, 'success');
            log(`ğŸ“ ä¿å­˜äº†è›‡é•¿åº¦: ${gameState.savedSnakeLength}`, 'success');
            
            updateStatus();
        }

        function simulateRevival() {
            if (!gameState.isGameOver) {
                log('âš ï¸ æ¸¸æˆå°šæœªç»“æŸï¼Œæ— æ³•å¤æ´»', 'warn');
                return;
            }
            
            if (!gameState.savedObstaclePositions) {
                log('âš ï¸ æ²¡æœ‰ä¿å­˜çš„éšœç¢ç‰©æ•°æ®', 'warn');
                return;
            }
            
            log('ğŸ”„ æ¨¡æ‹Ÿå¤æ´»...', 'info');
            
            gameState.isReviving = true;
            gameState.isGameOver = false;
            
            // æ¨¡æ‹Ÿæ¢å¤éšœç¢ç‰©
            const restoredCount = gameState.savedObstaclePositions.length;
            log(`ğŸ§± æ¢å¤äº† ${restoredCount} ä¸ªéšœç¢ç‰©`, 'success');
            log(`ğŸ“ æ¢å¤çš„éšœç¢ç‰©ä½ç½®: ${JSON.stringify(gameState.savedObstaclePositions.slice(0, 3))}...`, 'info');
            
            // éªŒè¯éšœç¢ç‰©ä½ç½®æ˜¯å¦ä¸€è‡´
            const positionsMatch = gameState.savedObstaclePositions.every((pos, index) => {
                return pos.x === gameState.savedObstaclePositions[index].x && 
                       pos.y === gameState.savedObstaclePositions[index].y;
            });
            
            if (positionsMatch) {
                log('âœ… éšœç¢ç‰©ä½ç½®å®Œå…¨ä¸€è‡´ï¼å¤æ´»æˆåŠŸï¼', 'success');
            } else {
                log('âŒ éšœç¢ç‰©ä½ç½®ä¸ä¸€è‡´ï¼å¤æ´»å¤±è´¥ï¼', 'error');
            }
            
            // æ¸…é™¤ä¿å­˜çš„æ•°æ®
            gameState.savedObstaclePositions = null;
            gameState.isReviving = false;
            
            updateStatus();
        }

        function checkObstacles() {
            log('ğŸ” æ£€æŸ¥éšœç¢ç‰©çŠ¶æ€...', 'info');
            
            if (gameState.savedObstaclePositions) {
                log(`ğŸ“Š å½“å‰ä¿å­˜çš„éšœç¢ç‰©: ${gameState.savedObstaclePositions.length}ä¸ª`, 'info');
                log(`ğŸ“ å‰3ä¸ªä½ç½®: ${JSON.stringify(gameState.savedObstaclePositions.slice(0, 3))}`, 'info');
            } else {
                log('ğŸ“Š å½“å‰æ²¡æœ‰ä¿å­˜çš„éšœç¢ç‰©', 'warn');
            }
            
            if (gameState.isReviving) {
                log('ğŸ”„ å½“å‰å¤„äºå¤æ´»çŠ¶æ€', 'info');
            }
            
            if (gameState.isGameOver) {
                log('ğŸ’€ å½“å‰å¤„äºæ¸¸æˆç»“æŸçŠ¶æ€', 'info');
            }
        }

        // åˆå§‹åŒ–
        updateStatus();
        log('ğŸ¯ æµ‹è¯•ç¯å¢ƒå·²å‡†å¤‡å°±ç»ª', 'success');
    </script>
</body>
</html> 